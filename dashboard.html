
<!DOCTYPE html>
<html>
<head>
  <title>Year 7 Exam Performance Dashboard</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {font-family: Arial, sans-serif; margin:0; background:#f4f6f9; color:#333;}
    header {background:#004080; color:white; padding:16px 24px;}
    header h1 {margin:0; font-size:22px;}
    header p {margin:4px 0 0 0; font-size:13px; opacity:0.9;}
    main {padding:16px 24px;}
    .top-bar {display:flex; flex-wrap:wrap; gap:16px; align-items:center; margin-bottom:16px;}
    .card {background:white; border-radius:10px; padding:16px; box-shadow:0 2px 8px rgba(0,0,0,0.08); margin-bottom:16px;}
    .card h2 {margin-top:0; font-size:18px;}
    .kpi-container {display:flex; flex-wrap:wrap; gap:16px;}
    .kpi {flex:1 1 160px; background:#f9fbff; border-radius:8px; padding:12px 14px; border:1px solid #dbe4f0;}
    .kpi-label {font-size:12px; text-transform:uppercase; color:#666; letter-spacing:0.5px;}
    .kpi-value {font-size:20px; font-weight:bold; margin-top:4px;}
    .controls label {font-size:13px; margin-right:6px;}
    select, input[type=file] {padding:6px 8px; font-size:13px;}
    canvas {max-width:100%; height:360px;}
    .charts-grid {display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:16px;}
    .placeholder {font-size:13px; color:#777;}
  </style>
</head>
<body>
  <header>
    <h1>Year 7 End-of-Year Exam Performance</h1>
    <p>Upload the <strong>YEAR 7</strong> analysis Excel file to view class and subject performance (% 1–6 and % 1–8) in real time.</p>
  </header>

  <main>
    <div class="top-bar card">
      <div>
        <label for="fileInput"><strong>1. Upload Excel file:</strong></label>
        <input type="file" id="fileInput" accept=".xlsx,.xls" />
      </div>
      <div class="controls">
        <label for="subjectSelect"><strong>2. Select subject:</strong></label>
        <select id="subjectSelect" disabled></select>

        <label for="metricSelect"><strong>Metric:</strong></label>
        <select id="metricSelect" disabled>
          <option value="pct1_6">% 1–6 (Distinction + Credit)</option>
          <option value="pct1_8">% 1–8 (Pass)</option>
        </select>
      </div>
    </div>

    <div class="card">
      <h2>Key Performance Indicators</h2>
      <div id="kpiWrapper" class="kpi-container">
        <div class="placeholder">Upload the Excel file to calculate overall KPIs (overall % 1–6, % 1–8 and total candidates).</div>
      </div>
    </div>

    <div class="charts-grid">
      <div class="card">
        <h2>Class Performance by Subject</h2>
        <p style="font-size:12px; color:#666; margin-top:-4px;">
          Shows the selected metric for each class in the chosen subject.
        </p>
        <canvas id="classChart"></canvas>
      </div>

      <div class="card">
        <h2>Subject Comparison (Overall)</h2>
        <p style="font-size:12px; color:#666; margin-top:-4px;">
          Compares overall performance across all subjects using the selected metric.
        </p>
        <canvas id="subjectChart"></canvas>
      </div>
    </div>
  </main>

  <script src="assets/script.js"></script>
</body>
</html>
